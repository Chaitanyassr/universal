/*!
GPII Preferences Server POST Handler

Copyright 2019 OCAD University

Licensed under the New BSD license. You may not use this file except in
compliance with this License.

You may obtain a copy of the License at
https://github.com/GPII/universal/blob/master/LICENSE.txt
*/

"use strict";

var fluid = require("infusion"),
    gpii = fluid.registerNamespace("gpii");

fluid.defaults("gpii.preferencesServer.post.handler", {
    gradeNames: ["kettle.request.http"],
    invokers: {
        handleRequest: {
            funcName: "gpii.preferencesServer.post.handler.createPreferences",
            args: ["{preferencesServer}", "{that}", "{that}.req.body", "{that}.req.query.view", "{that}.req.params.gpiiKey"]
        }
    }
});

gpii.preferencesServer.post.handler.createPreferences = function (preferencesServer, request, preferences, view, gpiiKey) {
    var prefsPromise = preferencesServer.createPreferences(preferences, view, gpiiKey);
    prefsPromise.then(request.events.onSuccess.fire, request.events.onError.fire);
};
